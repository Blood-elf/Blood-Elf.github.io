<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>十一、小智同学 | Blood-elf</title>
    <meta name="description" content="Just playing around">
    <link rel="icon" href="/favicon.png">
  <link rel="stylesheet" href="/css/style.css">
  <script charset="utf-8" src="/js/main.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.34ff1413.css" as="style"><link rel="preload" href="/assets/js/app.d141dca1.js" as="script"><link rel="preload" href="/assets/js/2.3338fc20.js" as="script"><link rel="preload" href="/assets/js/17.ec22f8e4.js" as="script"><link rel="prefetch" href="/assets/js/10.1ae9bd8b.js"><link rel="prefetch" href="/assets/js/100.3fe0b234.js"><link rel="prefetch" href="/assets/js/101.d11a6165.js"><link rel="prefetch" href="/assets/js/102.9d646381.js"><link rel="prefetch" href="/assets/js/103.f9e8e238.js"><link rel="prefetch" href="/assets/js/104.6f85cd04.js"><link rel="prefetch" href="/assets/js/105.44893955.js"><link rel="prefetch" href="/assets/js/106.08f71874.js"><link rel="prefetch" href="/assets/js/107.98ec668b.js"><link rel="prefetch" href="/assets/js/108.2e3bc1fc.js"><link rel="prefetch" href="/assets/js/109.61f3e842.js"><link rel="prefetch" href="/assets/js/11.97be4997.js"><link rel="prefetch" href="/assets/js/110.cf346c03.js"><link rel="prefetch" href="/assets/js/111.ac533fe2.js"><link rel="prefetch" href="/assets/js/112.1b6d2842.js"><link rel="prefetch" href="/assets/js/113.2d532978.js"><link rel="prefetch" href="/assets/js/114.b2d2f3ec.js"><link rel="prefetch" href="/assets/js/115.d7a5c8d2.js"><link rel="prefetch" href="/assets/js/116.b272fa47.js"><link rel="prefetch" href="/assets/js/117.2048675e.js"><link rel="prefetch" href="/assets/js/118.56bbc625.js"><link rel="prefetch" href="/assets/js/119.d62d253c.js"><link rel="prefetch" href="/assets/js/12.39e4754d.js"><link rel="prefetch" href="/assets/js/120.df52a956.js"><link rel="prefetch" href="/assets/js/121.e708bafb.js"><link rel="prefetch" href="/assets/js/122.41cacbe4.js"><link rel="prefetch" href="/assets/js/123.88681497.js"><link rel="prefetch" href="/assets/js/124.d2b93a7b.js"><link rel="prefetch" href="/assets/js/13.20b189ce.js"><link rel="prefetch" href="/assets/js/14.5cf84dd2.js"><link rel="prefetch" href="/assets/js/15.7db973cd.js"><link rel="prefetch" href="/assets/js/16.14f6e2e9.js"><link rel="prefetch" href="/assets/js/18.6e9f758c.js"><link rel="prefetch" href="/assets/js/19.6900722c.js"><link rel="prefetch" href="/assets/js/20.ddef478d.js"><link rel="prefetch" href="/assets/js/21.614905af.js"><link rel="prefetch" href="/assets/js/22.93551be2.js"><link rel="prefetch" href="/assets/js/23.22c2e0b2.js"><link rel="prefetch" href="/assets/js/24.b64cc7ad.js"><link rel="prefetch" href="/assets/js/25.d096308d.js"><link rel="prefetch" href="/assets/js/26.11af28a6.js"><link rel="prefetch" href="/assets/js/27.824f051c.js"><link rel="prefetch" href="/assets/js/28.a248d924.js"><link rel="prefetch" href="/assets/js/29.d6b45cea.js"><link rel="prefetch" href="/assets/js/3.3ed158ee.js"><link rel="prefetch" href="/assets/js/30.33aaedb5.js"><link rel="prefetch" href="/assets/js/31.1f858011.js"><link rel="prefetch" href="/assets/js/32.8a8fe43c.js"><link rel="prefetch" href="/assets/js/33.9669d98d.js"><link rel="prefetch" href="/assets/js/34.98d1a152.js"><link rel="prefetch" href="/assets/js/35.c6a97bd1.js"><link rel="prefetch" href="/assets/js/36.aa33deb9.js"><link rel="prefetch" href="/assets/js/37.00e031ce.js"><link rel="prefetch" href="/assets/js/38.0064a49d.js"><link rel="prefetch" href="/assets/js/39.3bfd12b2.js"><link rel="prefetch" href="/assets/js/4.0a474c48.js"><link rel="prefetch" href="/assets/js/40.c9aa506a.js"><link rel="prefetch" href="/assets/js/41.c641d3ad.js"><link rel="prefetch" href="/assets/js/42.ca0b826a.js"><link rel="prefetch" href="/assets/js/43.9d78ceb2.js"><link rel="prefetch" href="/assets/js/44.1c8631d5.js"><link rel="prefetch" href="/assets/js/45.87177a53.js"><link rel="prefetch" href="/assets/js/46.c5d167fe.js"><link rel="prefetch" href="/assets/js/47.a4cb5623.js"><link rel="prefetch" href="/assets/js/48.2d5671cc.js"><link rel="prefetch" href="/assets/js/49.a5571223.js"><link rel="prefetch" href="/assets/js/5.f6ebbbd7.js"><link rel="prefetch" href="/assets/js/50.7ea18df2.js"><link rel="prefetch" href="/assets/js/51.2c4d10b2.js"><link rel="prefetch" href="/assets/js/52.74a423ab.js"><link rel="prefetch" href="/assets/js/53.4649512f.js"><link rel="prefetch" href="/assets/js/54.871ac9c8.js"><link rel="prefetch" href="/assets/js/55.d4b9fd7a.js"><link rel="prefetch" href="/assets/js/56.5758b4bf.js"><link rel="prefetch" href="/assets/js/57.5656f3d9.js"><link rel="prefetch" href="/assets/js/58.6389b85a.js"><link rel="prefetch" href="/assets/js/59.a69b4255.js"><link rel="prefetch" href="/assets/js/6.957a5334.js"><link rel="prefetch" href="/assets/js/60.edd3fe9c.js"><link rel="prefetch" href="/assets/js/61.ba4b6feb.js"><link rel="prefetch" href="/assets/js/62.3df86942.js"><link rel="prefetch" href="/assets/js/63.d76f5281.js"><link rel="prefetch" href="/assets/js/64.b6fcdef8.js"><link rel="prefetch" href="/assets/js/65.dc6facb9.js"><link rel="prefetch" href="/assets/js/66.280b6efc.js"><link rel="prefetch" href="/assets/js/67.a337dcdb.js"><link rel="prefetch" href="/assets/js/68.ce1cce5c.js"><link rel="prefetch" href="/assets/js/69.af49473d.js"><link rel="prefetch" href="/assets/js/7.5346c4ac.js"><link rel="prefetch" href="/assets/js/70.ba7b389d.js"><link rel="prefetch" href="/assets/js/71.3cabe687.js"><link rel="prefetch" href="/assets/js/72.685879b9.js"><link rel="prefetch" href="/assets/js/73.638904a3.js"><link rel="prefetch" href="/assets/js/74.6e075733.js"><link rel="prefetch" href="/assets/js/75.ac283cad.js"><link rel="prefetch" href="/assets/js/76.cc22ef13.js"><link rel="prefetch" href="/assets/js/77.7df85444.js"><link rel="prefetch" href="/assets/js/78.e3d1dfd5.js"><link rel="prefetch" href="/assets/js/79.efd85d2b.js"><link rel="prefetch" href="/assets/js/8.c7e88e55.js"><link rel="prefetch" href="/assets/js/80.17fa534f.js"><link rel="prefetch" href="/assets/js/81.52e5b96e.js"><link rel="prefetch" href="/assets/js/82.806f8071.js"><link rel="prefetch" href="/assets/js/83.7a5aa025.js"><link rel="prefetch" href="/assets/js/84.f5ae8349.js"><link rel="prefetch" href="/assets/js/85.81c53ca9.js"><link rel="prefetch" href="/assets/js/86.bfe7121d.js"><link rel="prefetch" href="/assets/js/87.1f300e78.js"><link rel="prefetch" href="/assets/js/88.eeaa1d39.js"><link rel="prefetch" href="/assets/js/89.78195f9b.js"><link rel="prefetch" href="/assets/js/9.45c4e926.js"><link rel="prefetch" href="/assets/js/90.cf01763f.js"><link rel="prefetch" href="/assets/js/91.34261f85.js"><link rel="prefetch" href="/assets/js/92.2f2eb41e.js"><link rel="prefetch" href="/assets/js/93.465cd3cc.js"><link rel="prefetch" href="/assets/js/94.db66e291.js"><link rel="prefetch" href="/assets/js/95.5357f42c.js"><link rel="prefetch" href="/assets/js/96.f09d1cde.js"><link rel="prefetch" href="/assets/js/97.6dc881da.js"><link rel="prefetch" href="/assets/js/98.60c108e9.js"><link rel="prefetch" href="/assets/js/99.34a42de4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.34ff1413.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Blood-elf</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/guide/" class="nav-link">Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">STUDY</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础知识</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/nodejs/" class="nav-link">nodejs</a></li><li class="dropdown-subitem"><a href="/vuejs/base/" class="nav-link">vuejs</a></li><li class="dropdown-subitem"><a href="/es6/" class="nav-link">es6</a></li></ul></li><li class="dropdown-item"><h4>项目实战</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuejs/topline-pc/" class="nav-link">PC端</a></li><li class="dropdown-subitem"><a href="/vuejs/topline-mobile/" class="nav-link router-link-active">移动端</a></li></ul></li><li class="dropdown-item"><!----> <a href="/vuejs/extends/" class="nav-link">扩展</a></li><li class="dropdown-item"><h4>brower</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/" class="nav-link">ES6</a></li><li class="dropdown-subitem"><a href="/css/" class="nav-link">CSS3</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Archives</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuejs/vue-analysis/" class="nav-link">Vue 源码解析</a></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">ABOUT</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/guide/" class="nav-link">Guide</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">STUDY</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础知识</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/nodejs/" class="nav-link">nodejs</a></li><li class="dropdown-subitem"><a href="/vuejs/base/" class="nav-link">vuejs</a></li><li class="dropdown-subitem"><a href="/es6/" class="nav-link">es6</a></li></ul></li><li class="dropdown-item"><h4>项目实战</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuejs/topline-pc/" class="nav-link">PC端</a></li><li class="dropdown-subitem"><a href="/vuejs/topline-mobile/" class="nav-link router-link-active">移动端</a></li></ul></li><li class="dropdown-item"><!----> <a href="/vuejs/extends/" class="nav-link">扩展</a></li><li class="dropdown-item"><h4>brower</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/" class="nav-link">ES6</a></li><li class="dropdown-subitem"><a href="/css/" class="nav-link">CSS3</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Archives</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuejs/vue-analysis/" class="nav-link">Vue 源码解析</a></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">ABOUT</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vuejs/topline-mobile/" class="sidebar-link">项目实战（移动端）</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>移动端实战</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuejs/topline-mobile/chapter1.html" class="sidebar-link">一、项目初始化</a></li><li><a href="/vuejs/topline-mobile/chapter2.html" class="sidebar-link">二、从登陆开始</a></li><li><a href="/vuejs/topline-mobile/chapter3.html" class="sidebar-link">三、Token 处理</a></li><li><a href="/vuejs/topline-mobile/chapter4.html" class="sidebar-link">四、首页（上）</a></li><li><a href="/vuejs/topline-mobile/chapter5.html" class="sidebar-link">五、首页（下）</a></li><li><a href="/vuejs/topline-mobile/chapter6.html" class="sidebar-link">六、搜索</a></li><li><a href="/vuejs/topline-mobile/chapter7.html" class="sidebar-link">七、文章详情（上）</a></li><li><a href="/vuejs/topline-mobile/chapter8.html" class="sidebar-link">八、文章详情（下）</a></li><li><a href="/vuejs/topline-mobile/chapter9.html" class="sidebar-link">九、我的</a></li><li><a href="/vuejs/topline-mobile/chapter10.html" class="sidebar-link">十、编辑个人信息</a></li><li><a href="/vuejs/topline-mobile/chapter11.html" class="active sidebar-link">十一、小智同学</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#websocket" class="sidebar-link">WebSocket</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#介绍" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#基本使用" class="sidebar-link">基本使用</a></li><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#总结" class="sidebar-link">总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#socket-io" class="sidebar-link">Socket.IO</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#介绍-2" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#基本使用-2" class="sidebar-link">基本使用</a></li><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#总结-2" class="sidebar-link">总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#小智同学" class="sidebar-link">小智同学</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#准备" class="sidebar-link">准备</a></li><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#建立连接" class="sidebar-link">建立连接</a></li><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#收发消息" class="sidebar-link">收发消息</a></li><li class="sidebar-sub-header"><a href="/vuejs/topline-mobile/chapter11.html#展示消息列表" class="sidebar-link">展示消息列表</a></li></ul></li></ul></li><li><a href="/vuejs/topline-mobile/chapter12.html" class="sidebar-link">十二、功能优化</a></li><li><a href="/vuejs/topline-mobile/chapter13.html" class="sidebar-link">十三、打包发布</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="十一、小智同学"><a href="#十一、小智同学" aria-hidden="true" class="header-anchor">#</a> 十一、小智同学</h1> <img src="/assets/img/1566431856572.30ac4f69.png" width="300"> <h2 id="websocket"><a href="#websocket" aria-hidden="true" class="header-anchor">#</a> WebSocket</h2> <p><img src="data:image/png;base64,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" alt="img"></p> <h3 id="介绍"><a href="#介绍" aria-hidden="true" class="header-anchor">#</a> 介绍</h3> <ul><li>WebSocket 是一种数据通信协议，类似于我们常见的 http</li> <li>既然有 http，为啥还要 WebSocket</li> <li>http 通信是单向的
<ul><li>请求 + 响应</li> <li>没有请求也就没有响应</li></ul></li></ul> <p>初次接触 WebSocket 的人，都会问同样的问题：我们已经有了 HTTP 协议，为什么还需要另一个协议？它能带来什么好处？</p> <p>答案很简单，因为 HTTP 协议有一个缺陷：通信只能由客户端发起。</p> <p>举例来说，我们想了解今天的天气，只能是客户端向服务器发出请求，服务器返回查询结果。HTTP 协议做不到服务器主动向客户端推送信息。</p> <p>这种单向请求的特点，注定了如果服务器有连续的状态变化，客户端要获知就非常麻烦。我们只能使用<a href="https://www.pubnub.com/blog/2014-12-01-http-long-polling/" target="_blank" rel="noopener noreferrer">&quot;轮询&quot;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：每隔一段时候，就发出一个询问，了解服务器有没有新的信息。最典型的场景就是聊天室。</p> <p>轮询的效率低，非常浪费资源（因为必须不停连接，或者 HTTP 连接始终打开）。因此，工程师们一直在思考，有没有更好的方法。WebSocket 就是这样发明的。</p> <p>WebSocket 协议在2008年诞生，2011年成为国际标准。所有浏览器都已经支持了。</p> <p>它的最大特点就是，服务器可以主动向客户端推送信息，客户端也可以主动向服务器发送信息，是真正的双向平等对话，属于<a href="https://en.wikipedia.org/wiki/Push_technology" target="_blank" rel="noopener noreferrer">服务器推送技术<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的一种。</p> <p><img src="/assets/img/bg2017051502.01881d8f.png" alt="img"></p> <p>其他特点包括：</p> <p>（1）建立在 TCP 协议之上，服务器端的实现比较容易。</p> <p>（2）与 HTTP 协议有着良好的兼容性。默认端口也是80和443，并且握手阶段（第1次建立连接）采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。</p> <p>（3）数据格式比较轻量，性能开销小，通信高效。</p> <p>（4）可以发送文本，也可以发送二进制数据。</p> <p>（5）没有同源限制，客户端可以与任意服务器通信。</p> <p>（6）协议标识符是<code>ws</code>（如果加密，则为<code>wss</code>），服务器网址就是 URL。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ws://example.com:80/some/path
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/bg2017051503.49345da6.jpg" alt="img"></p> <h3 id="基本使用"><a href="#基本使用" aria-hidden="true" class="header-anchor">#</a> 基本使用</h3> <p>浏览器为 HTTP 通信提供了 XMLHttpRequest 对象，同样的，也为 WebSocket 通信提供了一个操作接口：WebSocket。</p> <p>通信模型：</p> <ul><li>拨号（建立连接）</li> <li>通话（双向通信）</li> <li>结束通话（关闭连接）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;wss://echo.websocket.org&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Connection open ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;Hello WebSockets!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;Received Message: &quot;</span> <span class="token operator">+</span> evt<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Connection closed.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h3> <h2 id="socket-io"><a href="#socket-io" aria-hidden="true" class="header-anchor">#</a> Socket.IO</h2> <h3 id="介绍-2"><a href="#介绍-2" aria-hidden="true" class="header-anchor">#</a> 介绍</h3> <ul><li><p>原生的 WebSocket 使用比较麻烦，所以推荐使用一个封装好的解决方案：socket.io</p></li> <li><p>socket.io 提供了服务端 + 客户端的实现</p> <ul><li>客户端：浏览器</li> <li>服务端：Java、Python、PHP、。。。。Node.js</li></ul></li> <li><p><a href="https://github.com/socketio/socket.io" target="_blank" rel="noopener noreferrer">GitHub 仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://socket.io/" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <h3 id="基本使用-2"><a href="#基本使用-2" aria-hidden="true" class="header-anchor">#</a> 基本使用</h3> <p>官方的 Hello World：https://socket.io/get-started/chat/。</p> <p>服务端代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> io <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'socket.io'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>http<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

io<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'disconnect'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'user disconnected'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'chat message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    io<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'chat message'</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

http<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listening on *:3000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>客户端代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype">&lt;!doctype html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Socket.IO chat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
      <span class="token selector">*</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token selector">body</span> <span class="token punctuation">{</span> <span class="token property">font</span><span class="token punctuation">:</span> 13px Helvetica<span class="token punctuation">,</span> Arial<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token selector">form</span> <span class="token punctuation">{</span> <span class="token property">background</span><span class="token punctuation">:</span> #000<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span> <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span> <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token selector">form input</span> <span class="token punctuation">{</span> <span class="token property">border</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span> 90%<span class="token punctuation">;</span> <span class="token property">margin-right</span><span class="token punctuation">:</span> .5%<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token selector">form button</span> <span class="token punctuation">{</span> <span class="token property">width</span><span class="token punctuation">:</span> 9%<span class="token punctuation">;</span> <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>130<span class="token punctuation">,</span> 224<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token selector">#messages</span> <span class="token punctuation">{</span> <span class="token property">list-style-type</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span> <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token selector">#messages li</span> <span class="token punctuation">{</span> <span class="token property">padding</span><span class="token punctuation">:</span> 5px 10px<span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token selector">#messages li:nth-child(odd)</span> <span class="token punctuation">{</span> <span class="token property">background</span><span class="token punctuation">:</span> #eee<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 消息列表 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>messages<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 发送消息的表单 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>m<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>off<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>Send<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- SocketIO 提供了一个客户端实现：socket.io.js --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/socket.io/socket.io.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://code.jquery.com/jquery-1.11.1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token comment">// 建立连接，得到 socket 通信对象</span>
      <span class="token keyword">var</span> socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

      socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'建立连接成功了'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'form'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prevents page reloading</span>
        socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'chat message'</span><span class="token punctuation">,</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#m'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#m'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'chat message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#messages'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;li&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h3 id="总结-2"><a href="#总结-2" aria-hidden="true" class="header-anchor">#</a> 总结</h3> <p>最简单的消息收发（没有类型，不好区分，客户端和服务端都一样）：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'数据'</span><span class="token punctuation">)</span>

socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>带有类型的消息（有类型，好区分，客户端和服务端都一样）：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'消息类型'</span><span class="token punctuation">,</span> <span class="token string">'数据'</span><span class="token punctuation">)</span>

socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'消息类型'</span><span class="token punctuation">,</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>广播（服务端）：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 广播给所有客户端</span>
io<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'some event'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token string">'everyone'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 广播给不包括当前客户端的其它客户端</span>
socket<span class="token punctuation">.</span>broadcast<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="小智同学"><a href="#小智同学" aria-hidden="true" class="header-anchor">#</a> 小智同学</h2> <h3 id="准备"><a href="#准备" aria-hidden="true" class="header-anchor">#</a> 准备</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>page-user-chat<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-nav-bar</span> <span class="token attr-name">fixed</span> <span class="token attr-name">left-arrow</span> <span class="token attr-name">@click-left</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>$router.back()<span class="token punctuation">&quot;</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>小智同学<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-nav-bar</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>chat-list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>chat-item<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{left:item.name==='xz',right:item.name==='self'}<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item,i) in list<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>i<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-image</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.name==='xz'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>cover<span class="token punctuation">&quot;</span></span> <span class="token attr-name">round</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>xzAvatar<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>chat-pao<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item.msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-image</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.name==='self'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>cover<span class="token punctuation">&quot;</span></span> <span class="token attr-name">round</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://img.yzcdn.cn/vant/cat.jpeg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>reply-container van-hairline--top<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-field</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>说点什么...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-loading</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>commentLoading<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>spinner<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>16px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-loading</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-else</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>send()<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">font-size</span><span class="token punctuation">:</span>12px<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>#999</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-field</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> xzAvatar <span class="token keyword">from</span> <span class="token string">'@/assets/images/xz.png'</span>
<span class="token keyword">import</span> io <span class="token keyword">from</span> <span class="token string">'socket.io-client'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> userLocal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/local'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      value<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      list<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      xzAvatar<span class="token punctuation">,</span>
      commentLoading<span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token string">'http://ttapi.research.itcast.cn'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      query<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        token<span class="token punctuation">:</span> userLocal<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>token
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 建了链接后默认  小智给你打招呼</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'xz'</span><span class="token punctuation">,</span> msg<span class="token punctuation">:</span> <span class="token string">'你好'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 接受机器人消息</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'xz'</span><span class="token punctuation">,</span> msg<span class="token punctuation">:</span> data<span class="token punctuation">.</span>msg <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">deactivated</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">scrollBottom</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>list<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>list<span class="token punctuation">.</span>scrollHeight
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">send</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> msg<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> timestamp<span class="token punctuation">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'self'</span><span class="token punctuation">,</span> msg<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">''</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.page-user-chat</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 46px 0 50px 0<span class="token selector">;
  .chat-list</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">overflow-y</span><span class="token punctuation">:</span> scroll<span class="token selector">;
    .chat-item</span> <span class="token punctuation">{</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token selector">;
      .van-image</span> <span class="token punctuation">{</span>
        <span class="token property">vertical-align</span><span class="token punctuation">:</span> top<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.chat-pao</span> <span class="token punctuation">{</span>
        <span class="token property">vertical-align</span><span class="token punctuation">:</span> top<span class="token punctuation">;</span>
        <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
        <span class="token property">min-width</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token property">max-width</span><span class="token punctuation">:</span> 60%<span class="token punctuation">;</span>
        <span class="token property">min-height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
        <span class="token property">line-height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 0.5px solid #c2d9ea<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 0 10px<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> #e0effb<span class="token punctuation">;</span>
        <span class="token property">word-break</span><span class="token punctuation">:</span> break-all<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token selector">;
        &amp;::before</span> <span class="token punctuation">{</span>
          <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
          <span class="token property">width</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
          <span class="token property">height</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
          <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
          <span class="token property">top</span><span class="token punctuation">:</span> 13px<span class="token punctuation">;</span>
          <span class="token property">border-top</span><span class="token punctuation">:</span> 1px solid #c2d9ea<span class="token punctuation">;</span>
          <span class="token property">border-right</span><span class="token punctuation">:</span> 1px solid #c2d9ea<span class="token punctuation">;</span>
          <span class="token property">background</span><span class="token punctuation">:</span> #e0effb<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token selector">.chat-item.right</span> <span class="token punctuation">{</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token selector">;
  .chat-pao</span> <span class="token punctuation">{</span>
    <span class="token property">margin-left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">margin-right</span><span class="token punctuation">:</span> 15px<span class="token selector">;
    &amp;::before</span> <span class="token punctuation">{</span>
      <span class="token property">right</span><span class="token punctuation">:</span> -6px<span class="token punctuation">;</span>
      <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>45deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token selector">.chat-item.left</span> <span class="token punctuation">{</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token selector">;
  .chat-pao</span> <span class="token punctuation">{</span>
    <span class="token property">margin-left</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
    <span class="token property">margin-right</span><span class="token punctuation">:</span> 0<span class="token selector">;
    &amp;::before</span> <span class="token punctuation">{</span>
      <span class="token property">left</span><span class="token punctuation">:</span> -6px<span class="token punctuation">;</span>
      <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>-135deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token selector">.van-image</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.reply-container</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 44px<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #f5f5f5<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 9999<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br></div></div><h3 id="建立连接"><a href="#建立连接" aria-hidden="true" class="header-anchor">#</a> 建立连接</h3> <p>步骤：</p> <ul><li>安装
<ul><li>https://github.com/socketio/socket.io-client</li></ul></li> <li>导入</li> <li>建立连接</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i socket.io-client
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>引入：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> io <span class="token keyword">from</span> <span class="token string">'socket.io-client'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>建立连接：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token string">'连接地址'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  query<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    token<span class="token punctuation">:</span> 用户token
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="收发消息"><a href="#收发消息" aria-hidden="true" class="header-anchor">#</a> 收发消息</h3> <h3 id="展示消息列表"><a href="#展示消息列表" aria-hidden="true" class="header-anchor">#</a> 展示消息列表</h3></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuejs/topline-mobile/chapter10.html" class="prev">十、编辑个人信息</a></span> <span class="next"><a href="/vuejs/topline-mobile/chapter12.html">十二、功能优化</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d141dca1.js" defer></script><script src="/assets/js/2.3338fc20.js" defer></script><script src="/assets/js/17.ec22f8e4.js" defer></script>
  </body>
</html>
